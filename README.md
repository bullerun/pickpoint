Рыскаль Никита Алексеевич

## Оглавление

1. [Основное задание](#task)
2. [Дополнительное задание](#extraTask)
3. [Мои ответы](#myAnswers)

### Основное задание <a name="task"></a>
- Реализуйте простое кэширование (In-memory Cache) для уменьшения нагрузки на базу данных вашего приложения
- Внедрите механизм инвалидации кэша, объясните свой выбор в документации пакета кэш-клиента (godoc/md)
- Необходимо реализовать сбор метрик с вашего приложения. Добавьте кастомную метрику по количеству выданных заказов



### Дополнительные задания: <a name="extraTask"></a>
- Добавьте ограничение потребления ресурсов вашего кэша (LRU/LFU или их модификации). Обновите документацию пакета кэширования
- Добавьте трейсинг запросов внутри приложения
- Выделите пакет кэширования в потенциально универсальный, с Generic типами ключей и значений, и конфигурацией снаружи (стратегия кэширования для экономии ресурсов, TTL кэшированных значений и др.)


### Мои ответы <a name="myAnswers"></a>

Использование кэша
---
У меня есть два LRU кэша. Один кэш используется для заказов, которые вернули, другой для обычных заказов.

### returnedCache

Данный кэш достаточно тривиальный, когда заказы приходят с PostgreSQL при вызове метода `GetReturned` они формируются в массив и попадают в кэш с ключом `returned:<offset>:<limit>`, после вызова метода `AcceptReturn` или `ReturnOrderToCourier`, кэш полностью очищается, т.к. нет возможности понять изменились ли закэшированные данные или нет.


### orderCache

Данный кэш используется для кэширования заказов, которые пришли после выполнения метода `ListOrders`, на самом деле в нашем проекте нет смысла держать в кэше весь заказ достаточно только держать `userID`, ключом для которого будет `orderID`. Благодаря такому кэшу мы можем валидировать:

`AddOrder` проверяя на то, есть ли у нас заказ с таким id или нет, если есть то нам нет смысла выполнять запрос в бд, если нету, то делаем запрос в бд, если удачный запрос, то добавляем в кэш.

`UpdateIssue` пробегая по всем переданным `OrderID`пытаясь узнать у всех ли заказов один и тот же получатель (UserID), если нет, то нам нет смысла выполнять запрос в бд.

